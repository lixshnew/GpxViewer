<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
    body, html,#all_map {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=3.0&ak=YourKey"></script>
    <title>地图展示</title>
</head>
<body>
    <div id="all_map"></div>
</body>
</html>
<script type="text/javascript">
    // 百度地图API功能
    var map = new BMap.Map("all_map");    // 创建Map实例
	

	map.centerAndZoom(new BMap.Point(window.external.GetCenterLon(), window.external.GetCenterLat()), 10);
   // map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);  // 初始化地图,设置中心点坐标和地图级别
    //添加地图类型控件
    map.addControl(new BMap.MapTypeControl({
        mapTypes:[
            BMAP_NORMAL_MAP,
            BMAP_HYBRID_MAP
        ]}));      
    map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
	
	var mypoints = [];
	var pointcnt= window.external.GetCount();
	
	for(var i = 0;  i  < window.external.GetCount();i++)
	{
	    var lat = window.external.GetLat();
		var lon = window.external.GetLon();
		mypoints.push(new BMap.Point(lon,lat));
	}

	var startpoint = mypoints[0];
	var endpoint = mypoints[pointcnt-1];

	var polyline = new BMap.Polyline(mypoints, {strokeColor:"blue", strokeWeight:6, strokeOpacity:0.5});   //创建折线
	map.addOverlay(polyline);   //增加折线
	
	var startMarker = new BMap.Marker(startpoint, {
    icon: new BMap.Symbol(BMap_Symbol_SHAPE_POINT, {
    scale: 1.5,//图标缩放大小
    fillColor: "green",//填充颜色
    fillOpacity: 0.8//填充透明度
    })
    });
	map.addOverlay(startMarker);
	
	var endMarker = new BMap.Marker(endpoint, {
    icon: new BMap.Symbol(BMap_Symbol_SHAPE_POINT, {
    scale: 1.5,//图标缩放大小
    fillColor: "red",//填充颜色
    fillOpacity: 0.8//填充透明度
    })
    });
	
	
	map.addOverlay(endMarker);

   
</script>